<!DOCTYPE html>
<html>
<head>
    <title>rouz.io</title>

    <link href='http://fonts.googleapis.com/css?family=Raleway:100,300' rel='stylesheet' type='text/css'>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

    <script src="bower_components/jquery/dist/jquery.min.js" type="text/javascript"></script>
    <script src="bower_components/angular/angular.min.js" type="text/javascript"></script>
    <script src="bower_components/angular-route/angular-route.min.js" type="text/javascript"></script>

    <style type="text/css">
        body {
            color: #333344;
            background-color: #fafafa;
            margin: 0;
            padding: 0;
        }

        body, p {
            font-family: 'Raleway', sans-serif;
            font-weight: 300;
        }

        h1, h2, h3 {
            font-family: 'Raleway', sans-serif;
            font-weight: 100;
            margin-bottom: 0.3em;
        }

        h1 { font-size: 5rem; }
        h2 { font-size: 3rem; }

        a, a:link, a:active {
            color: inherit;
            text-decoration: none;
        }

        button {
            font-size: 1rem;
        }

        .nofocus:focus {
            outline: 0;
        }

        .noselect {
            cursor: default;
        }

        .splash-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;

            background-color: #fafafa;
            font-weight: 100;

            -webkit-transition:
                color .7s,
                background-color 2s,
                bottom .3s,
                height .3s;
            transition:
                color .7s,
                background-color 2s,
                bottom .3s,
                height .3s;

            -webkit-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
               -moz-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
                 -o-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
                    transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
        }

        .splash {
            width: 100%;
            margin: 20% 0 0;

            text-align: center;
        }

        .splash, .splash h2 {
            width: 100%;

            -webkit-transition:
                font-size .5s,
                margin .5s,
                width .5s;
            transition:
                font-size .5s,
                margin .5s,
                width .5s;

            -webkit-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
               -moz-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
                 -o-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
                    transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
        }

        .slash h2 {
            letter-spacing: 10px;
        }

        .splash .title {
            margin: auto auto;
        }

        .splash .term {
            text-align: left;
        }

        .splash .term-icon-container, .splash .title-container {
            width: 100%;

            -webkit-transition: width .4s;
                    transition: width .4s;

            -webkit-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
               -moz-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
                 -o-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
                    transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
        }

        .splash .term .button {
            width: 40px;
            margin: 0 auto;
        }

        .splash .icon {
            background-color: transparent;
            border: none;
            display: inline-block;

            text-align: center;
            height: 7.3rem;

            cursor: pointer;

            -webkit-transition:
                color .4s,
                background-color 2s,
                border-radius 10s,
                width .4s,
                left 1s;
            transition:
                color .4s,
                background-color 2s,
                border-radius 10s,
                width .4s,
                left 1s;

            -webkit-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
               -moz-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
                 -o-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
                    transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
        }

        .splash .icon span {
            white-space: nowrap;
            position: absolute;
            left: 100%;
            opacity: 0;
            color: #222222;
        }

        .input {
            display: none;
            font-size: 2rem;

            position: relative;
            left: -90px;
        }

        .input .cursor {
            padding-left: 3px;
            font-size: 1.5em;
            line-height: 7.3rem;
            opacity: 1;

            -webkit-transition: opacity .3s;
                    transition: opacity .3s;

            -webkit-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
               -moz-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
                 -o-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
                    transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
        }

        .input .cursor.beat {
            opacity: 0;
        }

        .splash .icon i {
            -webkit-transition:
                opacity .2s,
                color 1s,
                text-shadow 1.5s;
            transition:
                opacity .2s,
                color 1s,
                text-shadow 1.5s;
        }

        .splash .icon i {
            font-size: 4rem;
            text-shadow: 0 0 10px #fefcc9;
        }

        .splash .icon.beat i {
            text-shadow: 0 0 8px #444444;
        }

        .nav {
            position: absolute;
            top: 0;
            right: -100%;
            height: 70px;
            margin: 0;
            padding: 0;

            -webkit-transition:
                right .4s;
            transition:
                right .4s;

            -webkit-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
               -moz-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
                 -o-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
                    transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
        }

        .nav li {
            display: inline-block;
            list-style: none;
            position: relative;
            width: 180px;
            height: 100%;
            color: #fafafa;
            font-size: 1em;

            cursor: pointer;

            -webkit-transition:
                color .7s,
                right .4s,
                font-size .2s;
            transition:
                color .7s,
                right .4s,
                font-size .2s;

            -webkit-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
               -moz-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
                 -o-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
                    transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
        }

        .nav li div.drop {
            background-color: #222222;
            position: fixed;
            width: 180px;
            height: 0;
            top: 0;

            overflow: visible;

            -webkit-transition:
                height .3s;
            transition:
                height .3s;

            -webkit-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
               -moz-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
                 -o-transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
                    transition-timing-function: cubic-bezier(0.230, 1.000, 0.320, 1.000);
        }

        .nav li div.text {
            padding: 26px 10px 0;
        }

        .nav li:hover {
            color: #222222;
            font-size: 1.4em;
        }

        .nav li:hover div.drop {
            background-color: #fafafa;
            height: 170px;
        }


        /* ===.splash-container.full === */

        .splash-container.up {
            height: 180px;
        }

        .splash-container.full .title-container {
            width: 305px;
        }

        .splash-container.full .term-icon-container {
            float: left;
            clear: left;
            width: 240px;
        }

        .splash-container.full .input {
            display: inline-block;
            float: left;
        }

        .splash-container.full .icon, .splash-container .splash.on .icon {
            color: #eaeaea;
        }

        .splash-container.full .icon {
            width: 40px;
        }

        .splash-container.full .icon i, .splash-container .splash.on .icon i {
            text-shadow: 3px 1px 0 #fdfd96;
        }

        .splash-container.full .icon {
            cursor: default;
        }

        .splash-container.full, .splash-container.on {
            background-color: #222222;
            color: #fafafa;
        }

        .splash-container.full .splash {
            margin: 15px 0 0;
        }

        .splash-container.full h2 {
            margin-top: 0;
            font-size: 2rem;
        }

        .splash-container.full .nav {
            right: 1.6rem;
        }


        article {
            margin: 20px 40px 0 152px;
        }

        #main-container {
            width: 100%;
            padding-top: 180px;
            bottom: -1px; /* so that there's always room to scroll */
        }

        #footer {
            background-color: #222222;
            color: #fafafa;
            height: 100px;
            padding: 10px 40px;
        }
    </style>

    <script type="text/javascript">

    angular.module('rouzio', ['ngRoute'], function() {})
        .constant('ARTICLE_MARGIN', 20)
        .constant('SPLASH_HEIGHT', 180)
        .factory('splashContainer', function splashContainer() {
            return $('.splash-container');
        });

    angular.module('rouzio')
        .service('TermService', function TermService() {
            var inputValue = '',
                inputValueAfter = '',
                lastSeenInput = '';
            var inputChangeFunc = function rootChangeHandler(){};

            function fullInput() {
                return inputValue + inputValueAfter;
            }

            function showInput() {
                inputChanged(fullInput());
            }

            function inputChanged(text) {
                if (lastSeenInput != text) {
                    console.log(text);
                    lastSeenInput = text;
                    inputChangeFunc(text);
                }
            }

            return {
                fullInput: fullInput,
                inputValue: function() { return inputValue; },
                inputValueAfter: function() { return inputValueAfter; },

                addInputChangeHandler: function(f) {
                    var prev = inputChangeFunc;
                    inputChangeFunc = function(text) {
                        prev(text);
                        f(text);
                    };
                },

                inputChar: function(c) {
                    inputValue += c;
                    showInput();
                },

                moveRight: function() {
                    inputValue += inputValueAfter.substring(0, 1);
                    inputValueAfter = inputValueAfter.substring(1, inputValueAfter.length);
                    showInput();
                },

                moveLeft: function() {
                    inputValueAfter = inputValue.substring(inputValue.length - 1, inputValue.length) + inputValueAfter;
                    inputValue = inputValue.substring(0, inputValue.length - 1);
                    showInput();
                },

                moveEnd: function() {
                    inputValue = inputValue + inputValueAfter;
                    inputValueAfter = '';
                    showInput();
                },

                removeBefore: function() {
                    inputValue = inputValue.substring(0, inputValue.length - 1);
                    showInput();
                },

                removeAfter: function() {
                    inputValueAfter = inputValueAfter.substring(1, inputValueAfter.length);
                    showInput();
                }
            }
        })
        .controller('TermCtrl', function TermCtrl($scope, $timeout, TermService, splashContainer, SPLASH_HEIGHT, ARTICLE_MARGIN) {

            // bind TermService fields to scope
            $scope.$watch(function() {
                $scope.inputValue = TermService.inputValue();
                $scope.inputValueAfter = TermService.inputValueAfter();
            })

            $scope.cursorOn = true;
            function cursorBeat() {
                $scope.cursorOn = !$scope.cursorOn;
                $timeout(cursorBeat, 700);
            }
            $timeout(cursorBeat, 700);


            $(window).keydown(function keydown(e) {
                $scope.$apply(function() {
                    switch (e.which) {
                        case 39: // right key
                            TermService.moveRight();
                            return;

                        case 37: // left key
                            TermService.moveLeft();
                            return;

                        case 8: // backspace
                            e.preventDefault();
                            TermService.removeBefore();
                            return;

                        case 46: // delete
                            TermService.removeAfter();
                            return;

                        default:
                            console.log('unhandled', e.which);
                    }
                });
            });
            $(window).keypress(function keypress(e) {
                if (!splashContainer.hasClass('full')) {
                    return;
                }
                $scope.$apply(function() {
                    e.preventDefault();
                    var c = String.fromCharCode(e.which);
                    TermService.inputChar(c);
                });
            });

            function setInputF(text, done) {
                function pace() {
                    var delay = 50;
                    var jitter = 35;
                    return delay + Math.floor(Math.random()*2*jitter) - jitter;
                }

                return function setInput() {
                    var remainingText = text.split('').reverse();

                    function printOne() {
                        if (remainingText.length > 0) {
                            TermService.inputChar(remainingText.pop());
                            $timeout(printOne, pace());
                        } else if (done != undefined) {
                            done(text);
                        }
                    }

                    function clearOne() {
                        if (TermService.inputValue() != '') {
                            TermService.removeBefore();
                            $timeout(clearOne, pace());
                        } else {
                            printOne();
                        }
                    }

                    TermService.moveEnd();
                    $timeout(clearOne, pace());
                }
            }

            function scrollToPage(page) {
                page = page.toLowerCase();
                var pageContainer = $('#' + page + '-page');
                $('html, body').animate({
                    scrollTop: pageContainer.offset().top - SPLASH_HEIGHT - ARTICLE_MARGIN
                }, 300);
            }

            var pages = ['contact', 'about'];
            TermService.addInputChangeHandler(function change(text) {
                var page = text.toLowerCase();
                if (pages.indexOf(page) > -1) {
                    splashContainer.addClass('up');
                    scrollToPage(page);
                } else {
                    // splashContainer.removeClass('up');
                }
            });

            $('.nav .about').click(setInputF('about'));
            $('.nav .contact').click(setInputF('contact'));
        });

    angular.module('rouzio')
        .controller('SplashCtrl', function SplashCtrl($scope, splashContainer) {
            var splash = $('.splash');
            var splashIcon = $('.splash .icon');
            var splashText = $('.splash h2');

            var isSplashFull = false;
            function splashFull() {
                if (isSplashFull) return;
                isSplashFull = true;

                splashContainer.addClass('full');
                splashIcon.find('i');
            }

            function iconBeat() {
                if (isSplashFull) return;
                splashIcon.toggleClass('beat');
                setTimeout(iconBeat, 1000);
            }
            setTimeout(iconBeat, 1000);

            splash.hover(function hoverOn() {
                splashContainer.addClass('on');
            }, function hoverOff() {
                splashContainer.removeClass('on');
            });

            splashIcon.hover(function hoverOn() {
                splash.addClass('on');
            }, function hoverOff() {
                splash.removeClass('on');
            });

            splashIcon.click(splashFull);
            $(window).scroll(splashFull);
        });

    </script>
</head>
<body ng-app="rouzio">

<div class="splash-container" ng-controller="SplashCtrl">
    <div class="splash">
        <div class="title-container">
            <div class="title">
                <h2 class="noselect">rouz.io</h2>
            </div>
        </div>

        <div ng-controller="TermCtrl" class="term noselect">
            <div class="term-icon-container">
                <div class="button">
                    <button class="icon nofocus" type="button">
                        <i class="fa fa-angle-right fa-lg"></i>
                    </button>
                </div>
            </div>
            <div class="input">
                <span class="value">{{inputValue}}</span><span class="cursor" ng-class="{beat: cursorOn}">_</span><span class="value-after">{{inputValueAfter}}</span>
            </div>
        </div>

        <ul class="nav">
            <li class="about">
                <div class="drop"><div class="text">about me</div></div>
            </li>
            <li class="contact">
                <div class="drop"><div class="text">contact</div></div>
            </li>
        </ul>
    </div>
</div>

<div id="main-container">
    <article id="about-page">
        <p style="width: 100px;">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras magna mi, finibus non sagittis sit amet, porttitor eget odio. Mauris quis neque quis augue iaculis vehicula. Sed posuere in nisl vitae malesuada. Integer ut laoreet dolor. Vivamus purus sem, hendrerit in tortor sit amet, porttitor sagittis felis. Phasellus at felis enim. Curabitur molestie tempus metus vitae fermentum. Nam augue arcu, interdum ac mi vitae, ullamcorper luctus metus. Morbi et ligula volutpat, egestas leo eu, rhoncus nunc.
        </p>
    </article>

    <article id="contact-page">
        <p style="width: 100px;">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras magna mi, finibus non sagittis sit amet, porttitor eget odio. Mauris quis neque quis augue iaculis vehicula. Sed posuere in nisl vitae malesuada. Integer ut laoreet dolor. Vivamus purus sem, hendrerit in tortor sit amet, porttitor sagittis felis. Phasellus at felis enim. Curabitur molestie tempus metus vitae fermentum. Nam augue arcu, interdum ac mi vitae, ullamcorper luctus metus. Morbi et ligula volutpat, egestas leo eu, rhoncus nunc.
        </p>
    </article>

    <div id="footer">
        <p>Curabitur molestie tempus metus</p>
    </div>
</div>

</body>
</html>
